-- 儿童管理卡及新生儿家庭方式记录上传 1
SELECT cp.id as chipersonid,cp.archives_num as archivesnum, cp.card_id as idcard,cp.hk_region as areacode, if(hcall.nose='2','1','0') as bi, cp.yz_day as cfyzt, DATE_FORMAT(cp.add_time,'%Y-%m-%d') as createDate, case tgl.labor_way when '1' then '1,0,0,0,0,0,0' when '23' then '0,1,0,0,0,0,0' when '21' then '0,0,1,0,0,0,0' when '3' then '0,0,0,1,0,0,0' when '22' then '0,0,0,0,1,0,0' else '0,0,0,0,0,0,1' end as csqk, DATE_FORMAT(cp.birthday,'%Y-%m-%d') as csrq, cp.height as cssc, (cp.weight/1000) as cstz, cp.yz_week as csyz, cp.hk_region as cun, cp.hkaddr as cunName, hd.user_id as czy, case hcall.feces_type when '1' then '0' when '2' then '1' else '2' end as db, if(hcall.ear in('2','3','4','5'),'1','0') as er, if(hcall.abdomen is NULL or hcall.abdomen='' or hcall.abdomen='01','0','1') as fb, DATE_FORMAT(apn.birthday,'%Y-%m-%d') as fqcsrq, apn.phone as fqlxdh, apn.card_id as fqsfzh, case when apn.profession_code in('10','11','13','14') then '5-14' when apn.profession_code in('05','06','07') then '5-13' when apn.profession_code in('04','08') then '5-11' when apn.profession_code='14' then '5-12' when apn.profession_code='09' then '5-15' when apn.profession_code='15' then '5-18' when apn.profession_code='16' then '5-22' else '5-17' end as fqzy, if(hcall.anus is NULL or hcall.anus='' or hcall.anus='1','0','1') as gm, cp.id as grdabh, case hcall.jaundice when '2' then '1,0,0,0,0' when '3' then '0,1,0,0,0' when '4' then '0,0,1,0,0' when '5' then '0,0,0,1,0' else '0,0,0,0,1' end as hdbw, hcall.breathing_rate as hxpl, if(hcall.neck='2','1','0') as jbbk, case when cp.comorbidity='2' then '1' when cp.comorbidity='3' then '2' when cp.comorbidity in('1','4','5','6','7','8','9','99') then '3' else '0' end as jbqk, concat(if(cp.dis_num='0' or cp.dis_num='' or cp.dis_num is NULL,'1','0'),',', if(cp.dis_num>'0' and sd.sc_result in('1','3'),'1','0'),',', if(cp.dis_num>'0' and sd.tsh_result='阳性','1','0'),',', if(cp.dis_num>'0' and sd.pku_result='阳性','1','0'),',', if(cp.dis_num>'0' and sd.cah_result='阳性','1','0'),',', if(cp.dis_num>'0' and sd.g6pd_result='阳性','1','0'),',', '0') as jbscyx, cp.hospital as jcjg, hh.text as jddw, hh.tel as jddwdh, apv.tel as jtdh, cp.xzaddr as jtzz, if(hcall.spine='02','1','0') as jz, '' as kh, if(hcall.mouth in('4','5','6','99'),'1','0') as kq, hd.name as lrrName, apv.name as lxr, apv.tel as lxrdh, hcall.pulse_rate as maibo, CASE WHEN hcall.face_colour='1' THEN '0' WHEN hcall.face_colour='2' THEN '1' ELSE '2' END as mianse, DATE_FORMAT(apv.birthday,'%Y-%m-%d') as mqcsrq, apv.phone as mqlxdh, apv.name as mqname, apv.card_id as mqsfzh, (hcall.weight/1000) as mqtz, case when apv.profession_code in('10','11','13','14') then '5-14' when apv.profession_code in('05','06','07') then '5-13' when apv.profession_code in('04','08') then '5-11' when apv.profession_code='14' then '5-12' when apv.profession_code='09' then '5-15' when apv.profession_code='15' then '5-18' when apv.profession_code='16' then '5-22' else '5-17' end as mqzy, cp.name as name, if(hcall.vomit='有','1','0') as ot, concat(if(hcall.skin='01','1','0'),if(hcall.skin='07','1','0'),if(hcall.skin='08','1','0'),if(hcall.skin not in('01','07','08'),'1','0'))as pf, concat(if(hcall.navel_cord='2','2','1'),',',if(hcall.navel_cord='1','2','1'),',','1',',',if(hcall.navel_cord='3','2','1')) as qd, hcall.km_size1 as qx, hcall.km_size2 as qx1, case hcall.fontanelle when '1' then '0' when '2' then '1' when '3' then '2' when '4' then '3' else '3' end as qxqk, cp.name as ryxm, if(cp.catface='' or cp.catface is NULL,'0','1') as sfjx, DATE_FORMAT(hcall.check_date,'%Y-%m-%d') as sfrq, hdhcall.name as sfys, hdhcall.user_id as sfyscode, cp.hkaddr as ssdwName, cp.hk_region as sssq, if(hcall.limb='2','1','0') as szhdd, hcall.temperature as tiwen, '' as tlsc, '' as updateid, if(cp.update_time is NULL, DATE_FORMAT(cp.add_time,'%Y-%m-%d') , DATE_FORMAT(cp.update_time,'%Y-%m-%d')) as updatetime, if(hcall.pudendum in('2','3','4','5','6','7','8','9','10','11'),'1','0') as wszq, CASE hcall.feed_way WHEN '1' THEN '0' WHEN '2' THEN '1' WHEN '3' THEN '2' END as wyfs, '' as wzd, hcall.next_place as xcsfdd, DATE_FORMAT(hcall.next_date,'%Y-%m-%d') as xcsfrq, if(hcall.heart_lungs in('2','3','4','5'),'1','0') as xf, cp.sex as xingbie, if(cp.choke='有','1','0') as xsezx, cp.cs_address as xxdz, if(hcall.eye in('2','3','4','5'),'1','0') as yan, concat(if(hcall.guide LIKE '%喂养指导%','1','0'),',',if(hcall.guide LIKE '%发育指导%','1','0'),',', if(hcall.guide LIKE '%防病指导%','1','0'),',',if(hcall.guide LIKE '%预防伤害指导%','1','0'),',',if(hcall.guide LIKE '%口腔保健指导%','1','0'),',','0') as zhidao, if(hcall.changer in('1','是'),'1','0') as zhuanzhen,  '0' as zxbzw  FROM t_chi_person cp LEFT JOIN t_gra_child AS gc ON gc.id=cp.gra_child_id and gc.statue='0' LEFT JOIN t_gra_labor AS tgl ON tgl.person_id=gc.person_id and tgl.statue='0' LEFT JOIN t_arc_person AS apv ON apv.id=cp.mother_id LEFT JOIN t_arc_person AS apn ON apn.id=cp.father_id LEFT JOIN t_chi_housecall AS hcall ON hcall.person_id=cp.id and hcall.statue='0' LEFT JOIN t_sc_card AS sc ON sc.child_id=cp.id and sc.statue='0' LEFT JOIN t_sc_data AS sd ON sd.code=sc.id JOIN t_hos_doctor AS hd ON hd.user_id=cp.add_user_id JOIN t_hos_hospital AS hh ON hh.id=cp.manage_unit_id LEFT JOIN t_hos_doctor AS hdhcall ON hdhcall.user_id=hcall.add_user_id WHERE 1=1 and cp.statue='0' and cp.id in (95307)


-- 儿童 1-8 月随访上传 2
SELECT one.id as chicheckoneid,cp.archives_num as archivesnum,	 cp.card_id as idcard , cp.name as name ,	 cp.hk_region as areacode ,	 '0' as bt ,	 DATE_FORMAT(one.check_date,'%Y-%m-%d') as createDate ,	 DATE_FORMAT(cp.birthday,'%Y-%m-%d') as csrq ,	 cp.hk_region as cun ,	 cp.hkaddr as cunName ,	 DATE_FORMAT(one.add_time,'%Y-%m-%d') as czsj ,	 one.add_user_id as czy ,	 if((one.r_ear='' or one.r_ear is NULL or one.r_ear='1') and (one.l_ear='' or one.l_ear is NULL or one.l_ear='1'),'0','1') as er ,	 if(one.belly='' or one.belly is NULL or one.belly='1','0','1') as fb ,	 if(apn.phone='' or apn.phone is NULL,'13800138000',apn.phone) as fqlxdh ,	 apn.name as fqname ,	 if(one.evaluation='' or one.evaluation is NULL or one.evaluation='01','0','1') as fypg ,	 if(one.genitals in('2','3','4','5','6','7','8','9','10','11'),'1','0') as gm ,	 cp.id as grdabh ,	 if(one.has_disease='' or one.has_disease is NULL or one.has_disease='未患病','0','1') as hbqk ,	 one.field_sport as hwhd ,	 cp.id as id ,	 if(one.neck='' or one.neck is NULL or one.neck='1','0','1') as jbbk ,	 apv.phone as jtdh ,	 if(one.mouth='' or one.mouth is NULL or one.mouth='1','0','1') as kq ,	 hd.name as lrrName ,	 apv.name as lxr ,	 apv.phone as lxrdh ,	 concat(if(one.complexion='1','1','0'),',',if(one.complexion='2','1','0'),',',if(one.complexion not in('1','2'),'1','0')) as mianse ,	 apv.name as mqname ,	 apv.card_id as mqsfzh ,	 if(one.face='' or one.face is NULL or one.face='01','0','1') as pifu ,	 concat(if(one.mesogastrium='2','2','1'),',',if(one.mesogastrium='1','2','1'),',',if(one.mesogastrium='3','2','1'),',',if(one.mesogastrium not in('1','2','3'),'2','1')) as qb ,	 if((one.mesogastrium='1') ,'1','0') as qb3 ,	 if(one.fontanelle='2','0','1') as qianxin ,	 one.km_size1 as qx ,	 one.km_size2 as qx1 ,	 cp.name as ryxm ,	 case when one.h_assess like '上%' then '0'	 when one.h_assess like '中%' then '1'	 when one.h_assess like '下%' then '2' else '1' end as scfl ,	 case when(one.rule_month=1) THEN '0' when (one.rule_month=3) THEN '1'	when (one.rule_month=6) THEN '2' when (one.rule_month=8) THEN '3' end as sfcs , DATE_FORMAT(one.check_date,'%Y-%m-%d') as sfrq ,	 hd.name as sfys ,	 one.height as shenchang ,	 cp.hkaddr as ssdwName ,	 cp.hk_region as sssq ,	 if(one.limb='' or one.limb is NULL or one.limb='1','0','1') as sz ,	 round(one.weight/1000,3) as tizhong ,	 if((one.r_hearing='02' or one.l_hearing='02'),'1','0') as tl ,	 one.head_size as tw ,	 case when one.w_assess like '上%' then '0'	 when one.w_assess like '中%' then '1'	 when one.w_assess like '下%' then '2' else '1' end as tzfl ,	 one.vitd as wss ,	 if(one.genitals in('2','3','4','5','6','7','8','9','10','11'),'1','0') as wszq ,	 '1' as wzd ,	 DATE_FORMAT(one.next_date,'%Y-%m-%d') as xcsfrq ,	 if(one.heart='' or one.heart is NULL or one.heart='1','0','1') as xf ,	 cp.sex as xingbie ,	 cp.xz_address as xxdz ,	 if((one.r_eye='' or one.r_eye is NULL or one.r_eye='1') and (one.l_eye='' or one.l_eye is NULL or one.l_eye='1'),'0','1') as yan ,	 concat(if(one.guide='1','1','0'),if(one.guide='2','1','0'),	 if(one.guide='3','1','0'),if(one.guide='4','1','0'),if(one.guide='5','1','0'),'0') as zhidao ,	 if(one.changer in('1','是'),'1','0') as zhuanzhen ,	 '0' as zxbzw 	 FROM t_chi_check_one one	 JOIN t_chi_person AS cp ON cp.id=one.person_id and cp.statue='0'	 LEFT JOIN t_arc_person AS apv ON apv.id=cp.mother_id and apv.statue='0'	 LEFT JOIN t_arc_person AS apn ON apn.id=cp.father_id and apn.statue='0'	 JOIN t_hos_doctor AS hd ON hd.user_id=one.add_user_id	 JOIN t_hos_hospital AS hh ON hh.id=hd.hospital_id	 WHERE one.statue='0' and one.rule_month<='8' and cp.id in (95307)


-- 儿童 12-30 月随访记录上传 3
SELECT	two.id as chichecktwoid,cp.archives_num as archivesnum, cp.card_id as idcard,	 cp.name as name,	 '0' as item,	 DATE_FORMAT(cp.birthday,'%Y-%m-%d') as csrq,	 cp.hk_region as cun,	 cp.hkaddr as cunName,	 two.tooth as cys,	 if((two.r_ear='' or two.r_ear is NULL or two.r_ear='1') and (two.l_ear='' or two.l_ear is NULL or two.l_ear='1'),'0','1') as er,	 if(two.belly='' or two.belly is NULL or two.belly='1','0','1') as fb,	 if(two.walking='1' or two.walking='' or two.walking is NULL,'0','1') as fypg,	 concat(if(two.rickets_sign='','1','0'),',',if(two.rickets_sign like '4','1','0'),',',if(two.rickets_sign like '5','1','0'),',',	 if(two.rickets_sign like '5','1','0'),',',if(two.rickets_sign like '7','1','0'),',',if(two.rickets_sign like '8','1','0'),','	 ,if(two.rickets_sign like '9','1','0'),',',if(two.rickets_sign like '10','1','0')) as glbtz,	 case when rickets_symptom like '%1%' then '夜惊' when rickets_symptom like '%2%' then '多汗' when rickets_symptom like '%3%' then '烦躁' else NULL end as glbzz,	 if(two.genitals in('2','3','4','5','6','7','8','9','10','11'),'1','0') as gm ,	 if(two.has_disease='' or two.has_disease is NULL or two.has_disease='未患病','0','1') as hbqk,	 '0' as hbqt,	 two.field_sport as hwhd,	 two.id as id,	 apv.phone as jtdh,	 '0' as kq,	 apv.name as lxr,	 apv.phone as lxrdh,	 concat(if(two.complexion='1','1','0'),',',if(two.complexion='2','1','0'),',',if(two.complexion not in('1','2'),'1','0')) as mianse,	 apv.name as mqname,	 '无' as paizhao,	 if(two.face='' or two.face is NULL or two.face='01','0','1') as pifu,	 if(two.fontanelle='2','1','0') as qianxin,	 two.km_size1 as qx,	 two.km_size1 as qx1,	 two.jc_tooth as qzs,	 cp.name as ryxm,	 case when two.h_assess like '上%' then '0'	 when two.h_assess like '中%' then '1'	 when two.h_assess like '下%' then '2' else '1' end as scfl,	 case when(two.rule_month=12) THEN '4' when (two.rule_month=18) THEN '5'	when (two.rule_month=24) THEN '6' when (two.rule_month=30) THEN '7' end as sfcs , DATE_FORMAT(two.check_date,'%Y-%m-%d') as sfrq ,	 hd.name as sfys ,	 two.add_user_id as sfyscode ,	 two.height as shenchang ,	 hh.text as ssdwName ,	 hh.code as sssq ,	 if(two.limb='' or two.limb is NULL or two.limb='1','0','1') as sz ,	 round(two.weight/1000,3) as tizhong ,	 if((two.r_hearing='02' or two.l_hearing='02'),'1','0') as tl ,	 case when two.w_assess like '上%' then '0'	 when two.w_assess like '中%' then '1'	 when two.w_assess like '下%' then '2' else '1' end as tzfl ,	 two.vitd as wss ,	 if(two.genitals in('2','3','4','5','6','7','8','9','10','11'),'1','0') as wszq ,	 if(two.heart='' or two.heart is NULL or two.heart='1','0','1') as xf ,	 cp.sex as xingbie ,	 cp.xz_address as xxdz ,	 if((two.r_eye='' or two.r_eye is NULL or two.r_eye='1') and (two.l_eye='' or two.l_eye is NULL or two.l_eye='1'),'0','1') as yan ,	 concat(if(two.guide like '%科学喂养%','1','0'),',',if(two.guide like '%生长发育%','1','0'),',',if(two.guide like '%疾病预防%','1','0'),',',	 if(two.guide like '%预防伤害%','1','0'),',',if(two.guide like '%口腔保健%','1','0'),',',if(two.guide like '%其他%','1','0')) as zhidao,	 if(two.changer in('1','是'),'1','0') as zhuanzhen ,	 two.change_unit as zzjg ,	 '' as zzqt ,	 two.change_cause as zzyy ,	 '' as ZZLXR ,	 '' as ZZLXFS ,	 '' as ZZRESULT ,	 DATE_FORMAT(two.check_date,'%Y-%m-%d') as CZSJ ,	 two.add_user_id as CZY ,	 DATE_FORMAT(two.add_time,'%Y-%m-%d') as CREATEDATE ,	 two.update_user_id as updateid ,	 if(two.update_time is NULL, DATE_FORMAT(two.add_time,'%Y-%m-%d'), DATE_FORMAT(two.update_time,'%Y-%m-%d')) as updatetime, if(two.walking='2','1','0') as bt, '0' as xhdb, '无' as zdqt FROM t_chi_check_two two	 JOIN t_chi_person AS cp ON cp.id=two.person_id and cp.statue='0'	 LEFT JOIN t_arc_person AS apv ON apv.id=cp.mother_id and apv.statue='0'	 LEFT JOIN t_arc_person AS apn ON apn.id=cp.father_id and apn.statue='0'	 JOIN t_hos_doctor AS hd ON hd.user_id=two.add_user_id	 JOIN t_hos_hospital AS hh ON hh.id=hd.hospital_id	 WHERE two.statue='0' and '12'<=two.rule_month<='30' 	 and cp.id in (95307)


-- 儿童 3-6 岁随访记录上传 4
SELECT three.id as chicheckthreeid,cp.archives_num as archivesnum, cp.card_id as idcard,	 cp.name as name,	 case when(three.rule_month=36) THEN '3' when (three.rule_month=48) THEN '4'	when (three.rule_month=60) THEN '5' when (three.rule_month=72) THEN '6' end as bz,	 DATE_FORMAT(cp.birthday,'%Y-%m-%d') as csrq,	 cp.hk_region as cun,	 cp.hkaddr as cunName,	 if(three.belly='' or three.belly is NULL or three.belly='1','0','1') as fb,	 if(three.disease like '%7%','1','0') as feiyan,	 if(three.disease like '%2%','1','0') as fuxie,	 cp.id as grdabh,	 if(three.disease='','无',getdictext('儿童系统','体格检查-患病记录',three.disease)) as hbqt,	 apv.phone as jtdh,	 apv.name as lxr,	 apv.phone as lxrdh,	 apv.name as mqname,	 apv.card_id as mqsfzh,	 '无' as qt,	 cp.name as ryxm,	 case when three.h_assess like '上%' then '0'	 when three.h_assess like '中%' then '1'	 when three.h_assess like '下%' then '2' else '1' end as scfl,	 DATE_FORMAT(three.check_date,'%Y-%m-%d') as sfrq,	 hd.name as sfys,	 three.add_user_id as sfyscode,	 three.height as shenchang,	 hh.text as ssdwName,	 hh.code as sssq,	 CONCAT(if(three.wh_assess ='正常','1','0'),',',if(three.wh_assess ='慢性严重营养不良','1','0'),',',if(three.wh_assess ='消瘦','1','0'),',',if(three.wh_assess = '生长迟缓','1','0'),',',if(three.wh_assess = '超重','1','0'),',',if(three.wh_assess ='肥胖','1','0')) as tgfypg, round(three.weight/1000,3) as tizhong,	 if((three.r_hearing='02' or three.l_hearing='02'),'0','1') as tl,	 case when three.w_assess like '上%' then '0'	 when three.w_assess like '中%' then '1'	 when three.w_assess like '下%' then '2' else '1' end as tzfl,	 three.l_vision as zy,	 three.r_vision as yy,	 '0' as waishang,	 '1' as wzd,	 DATE_FORMAT(three.next_date,'%Y-%m-%d') as xcsfrq,	 if(three.chest='1' or three.chest='' or three.chest is NULL,'0','1') as xf,	 '0' as xhdb,	 '0' as xhdbqt,	 cp.sex as xingbie,	 cp.xz_address as xxdz,	 concat(if(three.has_disease='未患病','1','0'),',',if(three.disease like '%7%','1','0'),',',if(three.disease like '%2%','1','0'),',',	 '0',',',if(three.disease like '%99%','1','0')) as yeqhbqk,	 three.tooth as ys,three.jc_tooth as jc,	 '' as zdqt,	 concat(if(three.guide like '%科学喂养%','1','0'),if(three.guide like '%生长发育%','1','0'),	 if(three.guide like '%疾病预防%','1','0'),if(three.guide like '%预防伤害%','1','0'),if(three.guide like '%口腔保健%','1','0'),'0') as zhidao,	 if(three.changer in('1','是'),'1','0') as zhuanzhen,	 three.change_unit as zzjg,	 '' as zzqt,	 three.change_cause as zzyy,	 '' as ZZLXR,	 '' as ZZLXFS,	 '' as ZZRESULT,	 DATE_FORMAT(three.check_date,'%Y-%m-%d') as CZSJ,	 three.add_user_id as CZY,	 DATE_FORMAT(three.add_time,'%Y-%m-%d') as CREATEDATE,	 if(three.update_user_id is NULL,three.add_user_id,three.update_user_id) as updateid,	 if(three.update_time is NULL,DATE_FORMAT(three.add_time,'%Y-%m-%d') , DATE_FORMAT(three.update_time,'%Y-%m-%d')) as updatetime	 FROM t_chi_check_three three	 JOIN t_chi_person AS cp ON cp.id=three.person_id and cp.statue='0'	 LEFT JOIN t_arc_person AS apv ON apv.id=cp.mother_id and apv.statue='0'	 LEFT JOIN t_arc_person AS apn ON apn.id=cp.father_id and apn.statue='0'	 JOIN t_hos_doctor AS hd ON hd.user_id=three.add_user_id	 JOIN t_hos_hospital AS hh ON hh.id=hd.hospital_id	 WHERE three.statue='0' and three.rule_month>='36'  and cp.id in (95307)



-- 妇女管理卡产前随访上传 5
SELECT	 gfv.id as gragfvid, apv.card_id as idcard ,	 apv.name as name ,	 apv.id as grdabh ,	 gbc.yc_num as jkid ,	 '无' as bchao ,	 ALB.result_statue  as bdb ,	 gfv.weight_index as bmi ,	 WBC.result_statue as bxb ,	 concat(if(gfv.deal_with like '%个人卫生%','1','0'),',',	 if(gfv.deal_with like '%心理%','1','0'),',',	 if(gfv.deal_with like '%膳食%','1','0'),',',	 if(gfv.deal_with like '%避免致畸因素和疾病对胚胎的不良影响%','1','0'),',',	 if(gfv.deal_with like '%产前筛查宣传告知%','1','0'),',',	 if(gfv.deal_with like '%生活方式%','1','0')) as byzd ,	 if(gfv.deal_with like '%生活方式%','生活方式','') as byzdqt ,	 gbc.ydfm_num as chanci ,	 gbc.jx_num as csqxe ,	 case gfv.lung WHEN '2' then '呼吸音粗' WHEN '3' THEN '肺部罗音' WHEN '4' THEN '其他' else '无' end as fbyc ,	 if(gfv.lung in('2','3','4'),'1','0') as feibu ,	 case gfv.annex when '2' then '有肿块' when '3' then '其他' when '4' then '拒检' when '1' then '未查' else '无' end as fjyc ,	 if(gbc.hasops='' or gbc.hasops is NULL or gbc.hasops like '%99%','0','1') as fksss ,	 if(gbc.hasops like '%8%','其他','无') as fksssqt ,	 if(gfv.annex='9' or gfv.annex='' or gfv.annex is NULL,'0','1') as fujian ,	 case gfv.uterine_neck when '2' then '外口粘合' when '3' then '宫颈瘢痕' when '4' then '宫颈水肿'	 when '5' then '宫颈坚韧' when '6' then '宫颈肌瘤' when '7' then '其他' else '无' end as gjyc ,	 if(gfv.uterine_neck='9' or gfv.uterine_neck='' or gfv.uterine_neck is NULL,'0','1') as gongji ,	 concat(if(gbc.grs_code like '%99%','1','0'),',',if(gbc.grs_code like '%1%','1','0'),',',if(gbc.grs_code like '%2%','1','0')	,',' ,if(gbc.grs_code like '%3%','1','0'),',',if(gbc.grs_code like '%4%','1','0'),',',if(gbc.grs_code like '%5%','1','0'),',',if(gbc.grs_code like '%7%','1','0')) as grs ,	 '' as grsqt ,	 case when HIV.result_statue='阴性' then '0' when HIV.result_statue='阳性' then '1' else '2' end as hiv ,	 TBiL.result as jhdhs ,	 concat(if(gbc.jwbs_code='' or gbc.jwbs_code is NULL or gbc.jwbs_code LIKE '%99%','1','0'),',',if(gbc.jwbs_code like '%01%','1','0'),',',if(gbc.jwbs_code like '%12%','1','0'),','	 ,if(gbc.jwbs_code like '%11%','1','0'),',',if(gbc.jwbs_code like '%07%','1','0'),',',if(gbc.jwbs_code like '%05%','1','0'),','	 ,if(gbc.jwbs_code like '%06%','1','0'),',',if(gbc.jwbs_code like '%18%','1','0')) as jws ,	 ''  as jwsqt ,	 concat(if(gbc.jzs_code like '%99%' or gbc.jzs_code='' or gbc.jzs_code is NULL,'1','0'),',',	 if(gbc.jzs_code like '%13%','1','0'),',',if(gbc.jzs_code like '%12%','1','0'),',',if(gbc.jzs_code like '%15%' or gbc.jzs_code like '%01%' or gbc.jzs_code like '%02%' or gbc.jzs_code like '%03%' or gbc.jzs_code like '%04%' or gbc.jzs_code like '%05%' or gbc.jzs_code like '%06%' or gbc.jzs_code like '%07%' or gbc.jzs_code like '%08%' or gbc.jzs_code like '%09%' or gbc.jzs_code like '%10%' or gbc.jzs_code like '%11%' or gbc.jzs_code like '%14%','1','0')) as jzs,	 '' as jzsqt ,	 (gbc.zrlc_num+gbc.rglc_num) as liuchan ,	 DATE_FORMAT(gbc.last_menses,'%Y-%m-%d') as mcyj ,	 '' as mcyjbx ,	 RPR.result_statue as mdxqsy ,	 '无' as ncgqt ,	 PRO1.result_statue as ndb ,	 '无' as niaotang ,	 '无' as nqx ,	 '无' as ntt ,	 gbc.pgc_num as pgc ,	 gfv.height as shengao ,	 gbc.sc_num as sichan ,	 gbc.st_num as sitai ,	 apv.hkaddr as sssq ,	 DATE_FORMAT(gbc.add_time,'%Y-%m-%d') as tbrq ,	 gbc.yz_week as tbyz ,	 gbc.yz_day as tbyztian ,	 gfv.weight as tizhong ,	 if(gfv.vulvae='2','1','0') as waiyin ,	 '无' as wyyc ,	 '无' as xcgqt ,	 HGB.result_statue as xhdb ,	 PLT.result_statue as xxb ,	 if(gfv.heart in('2','3','4','5','6'),'1','0') as xinzang ,	 BUN.result_statue as xnsd ,	 ALT.result_statue as xqgbzam ,	 AST.result_statue as xqgczam ,	 CREA.result_statue as xqjg ,	 gbc.newbabydeath as xsesw ,	 GLU.result_statue as xt ,	 ABO.result_statue as xuexiabo ,	 RH.result_statue as xuexirh ,	 PLT.result_statue as xxb ,	 gfv.up_blood as xy ,	 gfv.low_blood as xy1 ,	 '无' as xzyc ,	 gbc.expect_date as ycq ,	 '0,0,0,1,0' as ydfmw ,	 '' as ydfmwqt ,	 '5' as ydqjd ,	 '无' as ydyc ,	 SUBSTR(gp.current_age FROM 1 FOR 2) as yfnl ,	 if(gfv.cunt in('2','3','4','5','6'),'1','0') as yindao ,	 gbc.yc_num as yunci ,	 HBsAb.result_statue as yxgybmkt ,	 HBsAg.result_statue as yxgybmky ,	 HBeAb.result_statue as yxgyeke ,	 HBeAg.result_statue as yxgyeky ,	 HBcAb.result_statue as yxgykxkt ,	 TBiL.result_statue as zdhs,	 apn.phone as zfdh ,	 apn.name as zfname ,	 year(from_days(datediff(gbc.add_time,apn.birthday))) as zfnl ,	 '无' as zgyc ,	 if(gfv.changer='是','1','0') as zhuanzhen ,	 '0' as zigong ,	 if(gfv.assess='' or gfv.assess is NULL,'0','1') as ztpg ,	 gfv.assess as ztpgyc ,	 gfv.change_unit as zzjg ,	 gfv.change_cause as zzyy ,	 DATE_FORMAT(gfv.add_time,'%Y-%m-%d') as czsj ,	 '' as czy ,	 DATE_FORMAT(gfv.next_date,'%Y-%m-%d') as xcsfrq ,	 DATE_FORMAT(gfv.add_time,'%Y-%m-%d') as createdate ,	 '' as zzlxr ,	 '' as zzlxfs ,	 '' as zzresult ,	 gfv.check_doctor_name as sfys	 FROM t_gra_first_visit gfv	 JOIN t_gra_person AS gp ON gp.id=gfv.person_id and gp.statue='0'	 JOIN t_arc_person AS apv ON apv.id=gp.base_info_id and apv.statue='0'	 LEFT JOIN t_arc_person AS apn ON apn.id=gp.husband_info_id and apn.statue='0'	 JOIN t_gra_build_copy AS gbc ON gbc.person_id=gp.id and gbc.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS ALB ON ALB.person_id=gfv.person_id and ALB.dic_assist_id='127' and ALB.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS WBC ON WBC.person_id=gfv.person_id and WBC.dic_assist_id='240' and WBC.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS HIV ON HIV.person_id=gfv.person_id and HIV.dic_assist_id='191' and HIV.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS TBiL ON TBiL.person_id=gfv.person_id and TBiL.dic_assist_id='120' and TBiL.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS RPR ON RPR.person_id=gfv.person_id and RPR.dic_assist_id='192' and RPR.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS PRO1 ON PRO1 .person_id=gfv.person_id and PRO1.dic_assist_id='240' and PRO1.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS HGB ON HGB.person_id=gfv.person_id and HGB.dic_assist_id='67' and HGB.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS PLT ON PLT.person_id=gfv.person_id and PLT.dic_assist_id='82' and PLT.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS BUN ON BUN.person_id=gfv.person_id and BUN.dic_assist_id='131' and BUN.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS ALT ON ALT.person_id=gfv.person_id and ALT.dic_assist_id='122' and ALT.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS AST ON AST.person_id=gfv.person_id and AST.dic_assist_id='123' and AST.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS CREA ON CREA.person_id=gfv.person_id and CREA.dic_assist_id='132' and CREA.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS GLU ON GLU.person_id=gfv.person_id and GLU.dic_assist_id='184' and GLU.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS ABO ON ABO.person_id=gfv.person_id and ABO.dic_assist_id='212' and ABO.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS RH ON RH.person_id=gfv.person_id and RH.dic_assist_id='204' and RH.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS HBsAg ON HBsAg.person_id=gfv.person_id and HBsAg.dic_assist_id='136' and HBsAg.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS HBsAb ON HBsAb.person_id=gfv.person_id and HBsAb.dic_assist_id='137' and HBsAb.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS HBeAg ON HBeAg.person_id=gfv.person_id and HBeAg.dic_assist_id='138' and HBeAg.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS HBeAb ON HBeAb.person_id=gfv.person_id and HBeAb.dic_assist_id='139' and HBeAb.statue='0'	 LEFT JOIN t_gra_assist_check_fv AS HBcAb ON HBcAb .person_id=gfv.person_id and HBcAb.dic_assist_id='140' and HBcAb.statue='0'	 WHERE gfv.statue='0'  and apv.id in (371348)


-- 妇女 2-5 次随访上传 6
SELECT gp.id as gpidfive FROM t_gra_return_visit grv  JOIN t_gra_person AS gp ON gp.id=grv.person_id and gp.statue='0'  JOIN t_arc_person AS apv ON apv.id=gp.base_info_id and apv.statue='0'  LEFT JOIN t_arc_person AS apn ON apn.id=gp.husband_info_id and apn.statue='0'  JOIN t_hos_doctor AS hd ON hd.user_id=grv.add_user_id  JOIN t_hos_hospital AS hh ON hh.id=hd.hospital_id LEFT JOIN t_gra_build_copy copy on gp.id=copy.person_id WHERE grv.statue='0'  and apv.id in (371348) group by gp.id 

SQL SELECT grv.id as gragrvid, apv.card_id as idcard,  apv.name as name,  if(grv.has_except='1','0','1') as feilei,  grv.high_risk as flyc,  grv.girth_paunch as fuwei,  grv.fundal_height as gdgd,  apv.id as grdabh,  copy.yc_num as jkid,  '无' as paizhao,  '无' as ndb,  '无' as qtjc,  gp.fz_num as sfcs,  DATE_FORMAT(grv.check_date,'%Y-%m-%d') as sfrq,  hd.name as sfys,  grv.add_user_id as sfyscode,  hh.region_code as sssq,  grv.weight as tizhong,  grv.fetal_position as tw,  grv.fetal_heart as txl,  '0' as wzd,  DATE_FORMAT(grv.next_date,'%Y-%m-%d') as xcsfrq,  '无' as xhdbz,  grv.up_blood as xy,  grv.low_blood as xy1,  grv.yz_week as yunzhou,  grv.yz_day as yunzhoutian,  '' as zdqt,  concat(if(grv.deal_with like '%生活方式%','1','0'),',',if(grv.deal_with like '%营养%','1','0'),',',if(grv.deal_with like '%心理%','1','0'),',',  if(grv.deal_with like '%运动%','1','0'),',',if(grv.deal_with like '%自我监测%','1','0'),',',if(grv.deal_with like '%分娩准备%','1','0'),',',  if(grv.deal_with like '%母乳喂养%','1','0'),',','0') as zhidao,  if(grv.changer='是','1','0') as zhuanzhen,  grv.main_suit as zhusu,  '' as zxbzw,  grv.change_unit as zzjg,  grv.change_cause as zzyy,  '' as zzlxr,  '' as zzlxfs,  '' as zzresult,  '1' as xqxcqsc,  '' as xqxcqscqk,  hh.text as cqjcjgmc,  '0' as sffs  FROM t_gra_return_visit grv  JOIN t_gra_person AS gp ON gp.id=grv.person_id and gp.statue='0'  JOIN t_arc_person AS apv ON apv.id=gp.base_info_id and apv.statue='0'  LEFT JOIN t_arc_person AS apn ON apn.id=gp.husband_info_id and apn.statue='0'  JOIN t_hos_doctor AS hd ON hd.user_id=grv.add_user_id  JOIN t_hos_hospital AS hh ON hh.id=hd.hospital_id LEFT JOIN t_gra_build_copy copy on gp.id=copy.person_id WHERE 1=1 and gp.id = 73970 order by grv.check_date asc



 -- 妇女产后访视和 42 天上传    产后访视 7

SELECT	hcall.id as grahcallid, apv.card_id as idcard,	 apv.name as name,	 hcall.change_unit as cljg,	 hcall.change_cause as clyy,	 DATE_FORMAT(tgl.leave_hospital_date,'%Y-%m-%d') as cyrq,	 if(hcall.el_taste='1' or hcall.el_taste='' or hcall.el_taste is NULL,'0','1') as elu,	 if(hcall.el_taste='2','有臭味','无') as elyc,	 if(hcall.classify='未见异常','0','0') as fenlei,	 if(hcall.classify='异常',hcall.classify_other,'无') as flyc,	 DATE_FORMAT(tgl.labor_date,'%Y-%m-%d') as fmsj,	 apv.id as grdabh,	 copy.yc_num as jkid,	 apv.name as name,	 hcall.other as qita,	 if(hcall.breast in('1','2'),'1','0') as rufang,	 case hcall.breast when '1' then '硬结' when '2' then '红肿' else '无' end as rfyc,	 DATE_FORMAT(hcall.fs_date,'%Y-%m-%d') as sfrq,	 hd.name as sfys,	 hcall.add_user_id as sfyscode,	 if(hcall.fb_incision in('1','6','7','8') or hcall.fb_incision='' or hcall.fb_incision is NULL,'0','1')  as shangkou,	 case fb_incision when '2' then '红肿' when '3' then '渗液' when '4' then '裂开' when '5' then '化脓' else '无' end as skyc,	 hh.region_code as sssq,	 hcall.temperature as tiwen,	 '1' as wzd,	 DATE_FORMAT(hcall.next_fs_date,'%Y-%m-%d') as xcsfrq,	 hcall.up_blood as xy,	 hcall.low_blood as xy1,	 if(hcall.health='' or hcall.health is NULL,'未见异常',hcall.health) as ybjkzk,	 if(hcall.mental='' or hcall.mental is NULL,'未见异常',hcall.mental) as ybxlzk,	 '无' as zdqt,	 if(hcall.uterus='2','异常','无') as zgyc,	 concat(if(hcall.guidance like '%个人卫生%','1','0'),if(hcall.guidance like '%心理%','1','0'),if(hcall.guidance like '%营养%','1','0'), if(hcall.changer='是','1','0'),'0') as zhuanzhen,	 if(hcall.uterus='1','0','1') as zigong,	 '' as zzlxr,	 '' as zzresult,	 '' as zzlxfs,	 hcall.add_user_id as czy,	 DATE_FORMAT(hcall.add_time,'%Y-%m-%d') as czrq,	 '0' as sfbz,	 DATE_FORMAT(hcall.add_time,'%Y-%m-%d') as createdate,	 hcall.update_user_id as updateid,	 if(hcall.update_time is NULL,DATE_FORMAT(hcall.add_time,'%Y-%m-%d'),DATE_FORMAT(hcall.update_time,'%Y-%m-%d')) as updatetime, concat(if(hcall.guidance like '%个人卫生%','1','0'),',',if(hcall.guidance like '%心理%','1','0'),',',if(hcall.guidance like '%营养%','1','0'),',',if(hcall.guidance like '%母乳喂养%','1','0'),',',if(hcall.guidance like '%新生儿护理与喂养%','1','0'),',',if(hcall.guidance like '%其他%','1','0')) as zhidao FROM t_gra_housecall hcall	 JOIN t_gra_person AS gp ON gp.id=hcall.person_id and gp.statue='0'	 JOIN t_arc_person AS apv ON apv.id=gp.base_info_id and apv.statue='0'	 JOIN t_gra_labor AS tgl ON tgl.person_id=hcall.person_id and tgl.statue='0'	 JOIN t_hos_doctor AS hd ON hd.user_id=hcall.add_user_id	 JOIN t_hos_hospital AS hh ON hh.id=hd.hospital_id LEFT JOIN t_gra_build_copy copy on gp.id=copy.person_id	 WHERE hcall.statue='0'  and apv.id in (371348) ORDER BY hcall.add_time ASC


-- 妇女产后访视和 42 天上传     42 天上传 8
SELECT 	hcall42.id as grahcall42id,	 apv.card_id as idcard,	 apv.name as name,	 hcall42.change_unit as cljg,	 hcall42.change_cause as clyy,	 DATE_FORMAT(tgl.leave_hospital_date,'%Y-%m-%d') as cyrq,	 if(hcall42.el_taste='1' or hcall42.el_taste='' or hcall42.el_taste is NULL,'0','1') as elu,	 if(hcall42.el_taste='2','有臭味','无') as elyc,	 if(hcall42.classify='已恢复','0','1') as fenlei,	 if(hcall42.classify='未恢复',hcall42.classify_other,'无') as flyc,	 DATE_FORMAT(tgl.labor_date,'%Y-%m-%d') as fmsj,	 apv.id as grdabh,	 copy.yc_num as jkid,	 apv.name as name,	 hcall42.other as qita,	 if(hcall42.breast in('01','02'),'1','0') as rufang,	 case hcall42.breast when '01' then '乳腺炎' when '02' then '乳汁淤积' else '无' end as rfyc,	 DATE_FORMAT(hcall42.check_date,'%Y-%m-%d') as sfrq,	 hd.name as sfys,	 hcall42.add_user_id as sfyscode,	 if(hcall42.fb_incision in('1','6','7','8') or hcall42.fb_incision='' or hcall42.fb_incision is NULL,'0','1')  as shangkou,	 case fb_incision when '2' then '红肿' when '3' then '渗液' when '4' then '裂开' when '5' then '化脓' else '无' end as skyc,	 hh.region_code as sssq,	 '' as tiwen,	 '1' as wzd,	 '' as xcsfrq,	 hcall42.up_blood as xy,	 hcall42.low_blood as xy1,	 if(hcall42.health='' or hcall42.health is NULL,'未见异常',hcall42.health) as ybjkzk,	 if(hcall42.mental='' or hcall42.mental is NULL,'未见异常',hcall42.mental) as ybxlzk,	 '无' as zdqt,	 case hcall42.uterine_neck when '2' then '外口粘合' when '3' then '宫颈瘢痕' when '4' then '宫颈水肿'	 when '5' then '宫颈坚韧' when '6' then '宫颈肌瘤' when '7' then '其他' when '8' then '充血' else '无' end as zgyc,	 concat(if(hcall42.guide_type like '%性保健与避孕%','1','0'),',',if(hcall42.guide_type like '%心理保健%','1','0'),',',if(hcall42.guide_type like '%产妇营养%','1','0'),',',	 if(hcall42.guide_type like '%纯母乳喂养%','1','0'),',',if(hcall42.guide_type like '%婴儿喂养%','1','0'),',','0') as zhidao,	 if(hcall42.changer='是','1','0') as zhuanzhen,	 if(hcall42.uterine_neck in('2','3','4','5','6','7','8'),'1','0') as zigong,	 '' as zzlxr,	 '' as zzresult,	 '' as zzlxfs,	 hcall42.add_user_id as czy,	 DATE_FORMAT(hcall42.add_time,'%Y-%m-%d') as czrq,	 '1' as sfbz,	 DATE_FORMAT(hcall42.add_time,'%Y-%m-%d') as createdate,	 hcall42.update_user_id as updateid,	 if(hcall42.update_time is NULL,DATE_FORMAT(hcall42.add_time,'%Y-%m-%d'),DATE_FORMAT(hcall42.update_time,'%Y-%m-%d')) as updatetime	 FROM t_gra_labor42 hcall42	 JOIN t_gra_person AS gp ON gp.id=hcall42.person_id and gp.statue='0'	 JOIN t_arc_person AS apv ON apv.id=gp.base_info_id and apv.statue='0'	 JOIN t_gra_labor AS tgl ON tgl.person_id=hcall42.person_id and tgl.statue='0'	 JOIN t_hos_doctor AS hd ON hd.user_id=hcall42.add_user_id	 JOIN t_hos_hospital AS hh ON hh.id=hd.hospital_id LEFT JOIN t_gra_build_copy copy on gp.id=copy.person_id  WHERE hcall42.statue='0'  and apv.id in (371348)


